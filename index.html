<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Game</title>
    <style>
        .completed {
            background-color: #d3ffd3;
            text-decoration: line-through;
        }
        .task-card {
            border: 1px solid #ddd;
            padding: 10px;
            margin: 10px;
            border-radius: 5px;
        }
        .countdown {
            font-weight: bold;
        }
        .button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        .button:disabled {
            background-color: #ccc;
        }
        #overlay, #bonus, #referral, #shop {
            display: none;
        }
    </style>
</head>
<body>
    <div id="overlay">
        <input type="text" id="phone" placeholder="Enter your phone number">
        <button onclick="startGame()">Start Game</button>
    </div>

    <div id="game">
        <h1>Task Game</h1>
        <p>Points: <span id="points">0</span></p>
        <button onclick="openShop()">Open Shop</button>
        <button onclick="getBonus()">Get Bonus</button>
        <button onclick="referFriend()">Refer a Friend</button>
        <div id="tasks">
            <div class="task-card" id="task1">
                <h3>Task 1</h3>
                <p>Points: 1,000</p>
                <p class="countdown" id="countdown1">Available in: 24:00:00</p>
                <button onclick="completeTask(1)">Complete Task</button>
            </div>
            <div class="task-card" id="task2">
                <h3>Task 2</h3>
                <p>Points: 1,000</p>
                <p class="countdown" id="countdown2">Available in: 24:00:00</p>
                <button onclick="completeTask(2)">Complete Task</button>
            </div>
            <div class="task-card" id="task3">
                <h3>Task 3</h3>
                <p>Points: 1,000</p>
                <p class="countdown" id="countdown3">Available in: 24:00:00</p>
                <button onclick="completeTask(3)">Complete Task</button>
            </div>
            <div class="task-card" id="task4">
                <h3>Task 4</h3>
                <p>Points: 1,000</p>
                <p class="countdown" id="countdown4">Available in: 24:00:00</p>
                <button onclick="completeTask(4)">Complete Task</button>
            </div>
            <div class="task-card" id="task5">
                <h3>Task 5</h3>
                <p>Points: 1,000</p>
                <p class="countdown" id="countdown5">Available in: 24:00:00</p>
                <button onclick="completeTask(5)">Complete Task</button>
            </div>
            <div class="task-card" id="task6">
                <h3>Task 6</h3>
                <p>Points: 1,000</p>
                <p class="countdown" id="countdown6">Available in: 24:00:00</p>
                <button onclick="completeTask(6)">Complete Task</button>
            </div>
            <div class="task-card" id="task7">
                <h3>Install App</h3>
                <p>Points: 1,000</p>
                <p class="countdown" id="countdown7">Available in: 24:00:00</p>
                <button onclick="completeTask(7)">Complete Task</button>
            </div>
        </div>
        <button class="button" onclick="closeBonus()">Close Bonus</button>
    </div>

    <div id="shop">
        <h2>Shop</h2>
        <p>Card 1 Level: <span id="card1-level">0</span></p>
        <button class="button" onclick="purchaseCard(1)">Purchase Card 1</button>
        <p>Card 2 Level: <span id="card2-level">0</span></p>
        <button class="button" onclick="purchaseCard(2)">Purchase Card 2</button>
        <p>Card 3 Level: <span id="card3-level">0</span></p>
        <button class="button" onclick="purchaseCard(3)">Purchase Card 3</button>
        <p>Card 4 Level: <span id="card4-level">0</span></p>
        <button class="button" onclick="purchaseCard(4)">Purchase Card 4</button>
        <button class="button" onclick="closeShop()">Close Shop</button>
    </div>

    <div id="bonus">
        <h2>Bonus Tasks</h2>
        <!-- Bonus task elements here -->
    </div>

    <div id="referral">
        <h2>Refer a Friend</h2>
        <p>Share this link to refer a friend:</p>
        <input type="text" id="referral-link" readonly>
        <p>Clicks: <span id="clicks">0</span></p>
        <p>Referred Users: <span id="referred-users">0</span></p>
        <button class="button" onclick="closeReferFriend()">Close</button>
    </div>

    <script>
        const TASK_COOLDOWN = 24 * 60 * 60 * 1000; // 24 hours in milliseconds
        let points = 0;
        let globalPoints = 0;

        function startGame() {
            const phoneNumber = document.getElementById("phone").value;
            if (!phoneNumber) {
                alert("Please enter a phone number.");
                return;
            }
            localStorage.setItem("phoneNumber", phoneNumber);
            document.getElementById("overlay").style.display = "none";
            document.getElementById("game").style.display = "block";
            initializeGame();
        }

        function updateDateTime() {
            const now = new Date();
            const dateTimeString = now.toLocaleString();
            document.getElementById("datetime").innerText = dateTimeString;
        }

        function getTaskCooldown(taskId) {
            const lastCompletion = localStorage.getItem(`task${taskId}_completion`);
            if (!lastCompletion) return 0;
            const lastCompletionTime = new Date(lastCompletion).getTime();
            return Math.max(0, TASK_COOLDOWN - (Date.now() - lastCompletionTime));
        }

        function formatCountdown(ms) {
            const hours = Math.floor(ms / (1000 * 60 * 60));
            const minutes = Math.floor((ms % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((ms % (1000 * 60)) / 1000);
            return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        function updateTaskCountdowns() {
            for (let i = 1; i <= 7; i++) {
                const cooldown = getTaskCooldown(i);
                document.getElementById(`countdown${i}`).innerText = cooldown > 0 ? `Available in: ${formatCountdown(cooldown)}` : 'Available now';
            }
        }

        function completeTask(taskId) {
            const cooldown = getTaskCooldown(taskId);
            if (cooldown > 0) {
                alert(`You must wait ${formatCountdown(cooldown)} before completing this task again.`);
                return;
            }

            let completedTasks = JSON.parse(localStorage.getItem("phoneNumber_completedTasks")) || [];
            if (!completedTasks.includes(taskId)) {
                completedTasks.push(taskId);
                localStorage.setItem("phoneNumber_completedTasks", JSON.stringify(completedTasks));
                points += 1000;
                globalPoints += 1000;
                localStorage.setItem("points", globalPoints);
                localStorage.setItem("phoneNumber_points", points);
                localStorage.setItem(`task${taskId}_completion`, new Date().toISOString());
                updateTaskStatus();
                alert(`Task ${taskId} completed! You've earned 1,000 points.`);
            } else {
                alert(`Task ${taskId} has already been completed.`);
            }
            updateTaskCountdowns();
        }

        function updateTaskStatus() {
            for (let i = 1; i <= 7; i++) {
                const completedTasks = JSON.parse(localStorage.getItem("phoneNumber_completedTasks")) || [];
                const taskElement = document.getElementById(`task${i}`);
                if (completedTasks.includes(i)) {
                    taskElement.classList.add('completed');
                } else {
                    taskElement.classList.remove('completed');
                }
            }
        }

        function initializeGame() {
            points = parseInt(localStorage.getItem("phoneNumber_points") || "0");
            globalPoints = points;
            document.getElementById("points").innerText = points;
            updateTaskCountdowns();
            updateTaskStatus();
        }

        function openShop() {
            document.getElementById("shop").style.display = "block";
        }

        function closeShop() {
            document.getElementById("shop").style.display = "none";
        }

        function getBonus() {
            document.getElementById("bonus").style.display = "block";
        }

        function closeBonus() {
            document.getElementById("bonus").style.display = "none";
        }

        function referFriend() {
            document.getElementById("referral").style.display = "block";
            document.getElementById("referral-link").value = "http://example.com/referral-link";
        }

        function closeReferFriend() {
            document.getElementById("referral").style.display = "none";
        }

        function purchaseCard(cardNumber) {
            const cardLevelElement = document.getElementById(`card${cardNumber}-level`);
            let cardLevel = parseInt(cardLevelElement.innerText);
            cardLevel += 1;
            cardLevelElement.innerText = cardLevel;
        }

        // Prevent default actions for certain key presses and context menu
        document.addEventListener('contextmenu', (event) => event.preventDefault());
        document.addEventListener('keydown', (event) => {
            if (event.key === "F12" || (event.ctrlKey && event.shiftKey && event.key === "I")) {
                event.preventDefault();
            }
        });

        // Update the task countdowns every second
        setInterval(updateTaskCountdowns, 1000);

    </script>
</body>
</html>
